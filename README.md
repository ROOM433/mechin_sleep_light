# μ¤λ§νΈ μλ©΄ μ•λ μ‹μ¤ν…

ESP32 κΈ°λ°μ μλ©΄ ν¨ν„΄ λ¶„μ„μ„ ν†µν• μ¤λ§νΈ μ•λ μ‹μ¤ν…μ…λ‹λ‹¤. κ°€μ†λ„κ³„λ¥Ό μ‚¬μ©ν•μ—¬ μλ©΄ μƒνƒλ¥Ό μ‹¤μ‹κ°„μΌλ΅ λ¨λ‹ν„°λ§ν•κ³ , 90λ¶„ μλ©΄ μ‚¬μ΄ν΄μ„ κΈ°λ°μΌλ΅ μµμ μ μ‹κ°„μ— μ•λμ„ λ°μƒμ‹ν‚µλ‹λ‹¤.

## π€ μ£Όμ” κΈ°λ¥

- **μ‹¤μ‹κ°„ μλ©΄ λ¨λ‹ν„°λ§**: ADXL345 κ°€μ†λ„κ³„λ¥Ό μ‚¬μ©ν• μλ©΄ μƒνƒ μΈ΅μ •
- **μλ©΄ λ‹¨κ³„ λ¶„μ„**: μ›€μ§μ„ ν¨ν„΄μ„ κΈ°λ°μΌλ΅ ν• μλ©΄ λ‹¨κ³„ νλ‹¨ (κΉ¨μ–΄μμ/μ–•μ€μ /κΉμ€μ )
- **90λ¶„ μ‚¬μ΄ν΄ κΈ°λ° μ•λ**: μλ©΄ μ‚¬μ΄ν΄μ„ κ³ λ ¤ν• μµμ μ κΈ°μƒ μ‹κ°„ κ³„μ‚°
- **μ›Ή κΈ°λ° μ μ–΄**: μ§κ΄€μ μΈ μ›Ή μΈν„°νμ΄μ¤λ¥Ό ν†µν• μ•λ μ„¤μ • λ° λ¨λ‹ν„°λ§
- **μ‹¤μ‹κ°„ λ°μ΄ν„° μ‹κ°ν™”**: μλ©΄ λ°μ΄ν„°μ μ‹¤μ‹κ°„ μ°¨νΈ λ° μƒνƒ ν‘μ‹

## π“‹ μ‹μ¤ν… κµ¬μ„±

### ν•λ“μ›¨μ–΄
- **ESP32 κ°λ°λ³΄λ“**
- **ADXL345 κ°€μ†λ„κ³„ μ„Όμ„** (I2C μ—°κ²°)
- **λ¶€μ €** (μ•λμ©)
- **LED** (μƒνƒ ν‘μ‹μ©)
- **μ νΌ μ™€μ΄μ–΄**

### μ†ν”„νΈμ›¨μ–΄
- **ESP32 νμ›¨μ–΄** (Arduino IDE)
- **Node.js λ°±μ—”λ“ μ„λ²„**
- **μ›Ή ν”„λ΅ νΈμ—”λ“** (HTML/CSS/JavaScript)
- **WebSocket ν†µμ‹ **

## π”§ μ„¤μΉ λ° μ„¤μ •

### 1. ESP32 νμ›¨μ–΄ μ„¤μ •

1. Arduino IDEλ¥Ό μ„¤μΉν•κ³  ESP32 λ³΄λ“ ν¨ν‚¤μ§€λ¥Ό μ¶”κ°€ν•©λ‹λ‹¤.
2. λ‹¤μ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ„¤μΉν•©λ‹λ‹¤:
   - `WiFi` (ESP32 κΈ°λ³Έ λΌμ΄λΈλ¬λ¦¬)
   - `WebSocketsClient` (Arduino WebSockets λΌμ΄λΈλ¬λ¦¬)
   - `ArduinoJson` (JSON μ²λ¦¬ λΌμ΄λΈλ¬λ¦¬)
   - `Wire` (I2C ν†µμ‹ )

3. `esp32_sleep_monitor.ino` νμΌμ„ μ—΄κ³  λ‹¤μ μ„¤μ •μ„ μμ •ν•©λ‹λ‹¤:
   ```cpp
   #define WIFI_SSID     "YOUR_WIFI_SSID"
   #define WIFI_PASSWORD "YOUR_WIFI_PASSWORD"
   #define SERVER_HOST   "YOUR_SERVER_IP"
   #define SERVER_PORT   8080
   ```

4. ESP32μ— μ—…λ΅λ“ν•©λ‹λ‹¤.

### 2. ν•λ“μ›¨μ–΄ μ—°κ²°

```
ESP32    ADXL345
------   -------
3.3V  -> VCC
GND   -> GND
21    -> SDA
22    -> SCL

ESP32    λ¶€μ €/LED
------   --------
2     -> λ¶€μ € (+)
GND   -> λ¶€μ € (-)
4     -> LED (+)
GND   -> LED (-)
```

### 3. μ„λ²„ μ„¤μ •

1. Node.jsκ°€ μ„¤μΉλμ–΄ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
2. ν”„λ΅μ νΈ λ””λ ‰ν† λ¦¬μ—μ„ λ‹¤μ λ…λ Ήμ„ μ‹¤ν–‰ν•©λ‹λ‹¤:
   ```bash
   npm install
   ```

3. μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤:
   ```bash
   npm start
   ```

4. μ›Ή λΈλΌμ°μ €μ—μ„ `http://localhost:8080`μ— μ ‘μ†ν•©λ‹λ‹¤.

## π“± μ‚¬μ©λ²•

### 1. λ””λ°”μ΄μ¤ μ—°κ²° ν™•μΈ
- μ›Ή μΈν„°νμ΄μ¤μ—μ„ ESP32 λ””λ°”μ΄μ¤κ°€ μ—°κ²°λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
- μ—°κ²° μƒνƒλ” μƒλ‹¨ λ„¤λΉ„κ²μ΄μ… λ°”μ— ν‘μ‹λ©λ‹λ‹¤.

### 2. μ•λ μ„¤μ •
1. "λ©ν‘ κΈ°μƒ μ‹κ°„" ν•„λ“μ— μ›ν•λ” κΈ°μƒ μ‹κ°„μ„ μ…λ ¥ν•©λ‹λ‹¤.
2. "μ•λ μ„¤μ •" λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
3. μ‹μ¤ν…μ΄ 90λ¶„ μ‚¬μ΄ν΄μ„ κΈ°λ°μΌλ΅ μµμ μ μ•λ μ‹κ°„μ„ κ³„μ‚°ν•©λ‹λ‹¤.

### 3. μλ©΄ λ¨λ‹ν„°λ§ μ‹μ‘
1. "λ¨λ‹ν„°λ§ μ‹μ‘" λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
2. ESP32κ°€ μλ©΄ λ°μ΄ν„° μμ§‘μ„ μ‹μ‘ν•©λ‹λ‹¤.
3. μ‹¤μ‹κ°„ μ°¨νΈμ—μ„ μλ©΄ μƒνƒλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

### 4. μ•λ λ°μƒ
- μ„¤μ •λ μ‹κ°„μ΄ λλ©΄ ESP32μ—μ„ λ¶€μ €μ™€ LEDλ΅ μ•λμ΄ λ°μƒν•©λ‹λ‹¤.
- μ›Ή μΈν„°νμ΄μ¤μ—μ„λ„ μ•λ λ°μƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

## π”¬ μλ©΄ λ¶„μ„ μ•κ³ λ¦¬μ¦

### μλ©΄ λ‹¨κ³„ νλ‹¨
- **μ›€μ§μ„ μ μ** κΈ°λ°μΌλ΅ μλ©΄ λ‹¨κ³„λ¥Ό νλ‹¨ν•©λ‹λ‹¤:
  - μ›€μ§μ„ μ μ < 0.1: κΉμ€μ  (Stage 2)
  - μ›€μ§μ„ μ μ < 0.3: μ–•μ€μ  (Stage 1)
  - μ›€μ§μ„ μ μ β‰¥ 0.3: κΉ¨μ–΄μμ (Stage 0)

### 90λ¶„ μ‚¬μ΄ν΄ κ³„μ‚°
- μΈκ°„μ μλ©΄μ€ μ•½ 90λ¶„ μ£ΌκΈ°λ΅ λ°λ³µλ©λ‹λ‹¤.
- λ©ν‘ κΈ°μƒ μ‹κ°„μ—μ„ 90λ¶„ λ‹¨μ„λ΅ μ—­μ‚°ν•μ—¬ μµμ μ μ•λ μ‹κ°„μ„ κ³„μ‚°ν•©λ‹λ‹¤.
- μ–•μ€μ  λ‹¨κ³„μ—μ„ κΉ¨μ°κΈ° μ„ν•΄ 15λ¶„μ μ—¬μ  μ‹κ°„μ„ μ¶”κ°€ν•©λ‹λ‹¤.

## π“ API λ¬Έμ„

### WebSocket λ©”μ‹μ§€

#### ESP32 β†’ μ„λ²„
```json
{
  "device_id": "ESP32_001",
  "data_type": "sleep_data",
  "timestamp": 1234567890,
  "data": [
    {
      "x": 0.1,
      "y": 0.2,
      "z": 9.8,
      "roll": 5.2,
      "pitch": -3.1,
      "timestamp": 1234567890,
      "sleep_stage": 1,
      "movement_score": 0.15
    }
  ]
}
```

#### μ„λ²„ β†’ ESP32
```json
{
  "command": "start_monitoring",
  "timestamp": 1234567890
}
```

### REST API

#### μ•λ μ„¤μ •
```
POST /api/alarm/set
Content-Type: application/json

{
  "targetWakeTime": 1234567890,
  "deviceId": "ESP32_001"
}
```

#### μλ©΄ λ¨λ‹ν„°λ§ μ‹μ‘
```
POST /api/sleep/start
Content-Type: application/json

{
  "deviceId": "ESP32_001"
}
```

## π› οΈ λ¬Έμ  ν•΄κ²°

### ESP32 μ—°κ²° λ¬Έμ 
- WiFi μ„¤μ •μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈν•©λ‹λ‹¤.
- μ„λ²„ IP μ£Όμ†κ°€ μ •ν™•ν•μ§€ ν™•μΈν•©λ‹λ‹¤.
- λ°©ν™”λ²½ μ„¤μ •μ„ ν™•μΈν•©λ‹λ‹¤.

### μ„Όμ„ λ°μ΄ν„° λ¬Έμ 
- ADXL345 μ„Όμ„ μ—°κ²°μ„ ν™•μΈν•©λ‹λ‹¤.
- I2C μ£Όμ†κ°€ μ¬λ°”λ¥Έμ§€ ν™•μΈν•©λ‹λ‹¤ (κΈ°λ³Έκ°’: 0x53).

### μ›Ή μΈν„°νμ΄μ¤ λ¬Έμ 
- λΈλΌμ°μ € μ½μ†”μ—μ„ μ¤λ¥ λ©”μ‹μ§€λ¥Ό ν™•μΈν•©λ‹λ‹¤.
- WebSocket μ—°κ²° μƒνƒλ¥Ό ν™•μΈν•©λ‹λ‹¤.

## π“ ν–¥ν›„ κ°μ„  μ‚¬ν•­

- [ ] λ” μ •κµν• μλ©΄ λ‹¨κ³„ λ¶„μ„ μ•κ³ λ¦¬μ¦
- [ ] λ¨Έμ‹ λ¬λ‹ κΈ°λ° μλ©΄ ν¨ν„΄ ν•™μµ
- [ ] λ¨λ°”μΌ μ•± κ°λ°
- [ ] λ‹¤μ¤‘ μ‚¬μ©μ μ§€μ›
- [ ] μλ©΄ λ¦¬ν¬νΈ μƒμ„±
- [ ] μμ„± μ•λ κΈ°λ¥

## π“„ λΌμ΄μ„ μ¤

MIT License

## π¤ κΈ°μ—¬ν•κΈ°

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## π“ λ¬Έμ

ν”„λ΅μ νΈμ— λ€ν• λ¬Έμμ‚¬ν•­μ΄ μμΌμ‹λ©΄ μ΄μλ¥Ό μƒμ„±ν•΄ μ£Όμ„Έμ”.